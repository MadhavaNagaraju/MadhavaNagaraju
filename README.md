#------------------------------------------------------------------------
# Source File Information (DO NOT MODIFY)
# Source ID: f421fa11-8f24-4c17-a73b-598a253a9de4
# Source File: C:\Users\MNRaju\Desktop\MIM check list\MIM_Checklist.psf
#------------------------------------------------------------------------

<#
    .NOTES
    --------------------------------------------------------------------------------
     Code generated by:  SAPIEN Technologies, Inc., PowerShell Studio 2020 v5.7.172
     Generated on:       8/31/2024 4:11 AM
     Generated by:       MNRaju
    --------------------------------------------------------------------------------
    .DESCRIPTION
        GUI script generated by PowerShell Studio 2020
#>


#----------------------------------------------
#region Application Functions
#----------------------------------------------

#endregion Application Functions

#----------------------------------------------
# Generated Form Function
#----------------------------------------------
function Show-MIM_Checklist_psf {

	#----------------------------------------------
	#region Import the Assemblies
	#----------------------------------------------
	[void][reflection.assembly]::Load('System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089')
	[void][reflection.assembly]::Load('System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a')
	[void][reflection.assembly]::Load('System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a')
	#endregion Import Assemblies

	#----------------------------------------------
	#region Generated Form Objects
	#----------------------------------------------
	[System.Windows.Forms.Application]::EnableVisualStyles()
	$formSQLDBAToolWF = New-Object 'System.Windows.Forms.Form'
	$tbCntrlEacoChecklist = New-Object 'System.Windows.Forms.TabControl'
	$tabpage1 = New-Object 'System.Windows.Forms.TabPage'
	$groupBox_Details = New-Object 'System.Windows.Forms.GroupBox'
	$lbl_Progress = New-Object 'System.Windows.Forms.Label'
	$dataGrid_IndividualInfo = New-Object 'System.Windows.Forms.DataGridView'
	$groupBox_Report = New-Object 'System.Windows.Forms.GroupBox'
	$groupBox_Note = New-Object 'System.Windows.Forms.GroupBox'
	$groupbox1 = New-Object 'System.Windows.Forms.GroupBox'
	$treeViewObject = New-Object 'System.Windows.Forms.TreeView'
	$treeview_Feature = New-Object 'System.Windows.Forms.TreeView'
	$treeview_DBLevel = New-Object 'System.Windows.Forms.TreeView'
	$grpbox_ServerDetails = New-Object 'System.Windows.Forms.GroupBox'
	$cmbBoxObjectType = New-Object 'System.Windows.Forms.ComboBox'
	$lblType = New-Object 'System.Windows.Forms.Label'
	$cmbBoxObjectsDisplay = New-Object 'System.Windows.Forms.ComboBox'
	$textbox_SQLInstance = New-Object 'System.Windows.Forms.TextBox'
	$picBox = New-Object 'System.Windows.Forms.PictureBox'
	$combo_DBSelection = New-Object 'System.Windows.Forms.ComboBox'
	$lbl_DBName = New-Object 'System.Windows.Forms.Label'
	$lbl_SQLInstance = New-Object 'System.Windows.Forms.Label'
	$cbx_SQLDBSelection = New-Object 'System.Windows.Forms.ComboBox'
	$lbl_Instance_DB = New-Object 'System.Windows.Forms.Label'
	$menustrip1 = New-Object 'System.Windows.Forms.MenuStrip'
	$fileToolStripMenuItem = New-Object 'System.Windows.Forms.ToolStripMenuItem'
	$exitToolStripMenuItem = New-Object 'System.Windows.Forms.ToolStripMenuItem'
	$helpToolStripMenuItem = New-Object 'System.Windows.Forms.ToolStripMenuItem'
	$aboutToolStripMenuItem = New-Object 'System.Windows.Forms.ToolStripMenuItem'
	$labelLabel2 = New-Object 'System.Windows.Forms.Label'
	$button1 = New-Object 'System.Windows.Forms.Button'
	$InitialFormWindowState = New-Object 'System.Windows.Forms.FormWindowState'
	#endregion Generated Form Objects

	#----------------------------------------------
	# User Generated Script
	#----------------------------------------------
	
	$formSQLDBAToolWF_Load = {
		
		$lbl_SQLInstance.Visible = $false
		$textbox_SQLInstance.Visible = $false
		$lbl_DBName.Visible = $false
		$combo_DBSelection.Visible = $false
		
			
	}
	
	$label_Note1 = New-Object System.Windows.Forms.Label
	$label_Note1.Location = New-Object System.Drawing.Size(15, 15)
	
	$label_Note2 = New-Object System.Windows.Forms.Label
	$label_Note2.Location = New-Object System.Drawing.Size(15, 35)
	
	$global:gridReportwidth = 0
	$global:comboDBSelectedItem =''
	
	# Instance Level Queries
	$tb_DBNameQuery = "select top(1) name,database_id, log_reuse_wait_desc from sys.databases"
	$query_SQLRunningStatus= "select  name,database_id, log_reuse_wait_desc from sys.databases"
	$query_Sp_who2 = "sp_who2"
	$query_waitfordelay = "waitfor delay '0:0:03'"
	
	
	# Database Level Queries
	$tb_DBNameQuery = "select name,database_id, log_reuse_wait_desc from sys.databases"
	$query_SQLRunningStatus1 = "select top(1) name,database_id, log_reuse_wait_desc from sys.databases"
	$query_SQLRunningStatus10 = "select name,database_id, log_reuse_wait_desc from sys.databases"
	$query_Sp_who2 = "sp_who2"
	
	
	$allnodes = New-Object System.Collections.ArrayList
	
	function GetInstanceLevelQueryResults ()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Data.DataTable])]
		param
		(
			[parameter(Mandatory = $true , Position=0)]
			[string]$ServerName,
			[parameter(Mandatory = $true, Position = 1)]
			[string]$Query
		)
		try
		{
			$ErrorActionPreference = 'Stop'
			
			$lbl_Progress.Visible=$true
			if ($groupBox_Details.Controls.Contains($dataGrid_IndividualInfo))
			{
				$groupBox_Details.Controls.Remove($dataGrid_IndividualInfo)
			}
			if (!$groupBox_Details.Controls.Contains($lbl_Progress))
			{			
				$groupBox_Details.Controls.Add($lbl_Progress)	
		    }
			$groupBox_Details.Refresh()
			
			$Sqlconn = New-Object System.Data.SqlClient.SqlConnection("Server=$ServerName;Trusted_Connection=true;")
			$Sqlconn.Open()
			$sqlcommand = $Sqlconn.CreateCommand()
			$sqlcommand.CommandText = $Query
			$sqlcommand.CommandTimeout = 20
			$adapter = New-Object System.Data.SqlClient.SqlDataAdapter($sqlcommand)
			$tblQueryResult = New-Object System.Data.DataTable
			$adapter.Fill($tblQueryResult) | Out-Null
			
			if ($groupBox_Details.Controls.Contains($lbl_Progress))
			{
				$groupBox_Details.Controls.Remove($lbl_Progress)
			}
			if (!$groupBox_Details.Controls.Contains($dataGrid_IndividualInfo))
			{
				$groupBox_Details.Controls.Add($dataGrid_IndividualInfo)
			}
					
			return ,$tblQueryResult
		}
		catch [Exception]
		{
			if ($groupBox_Details.Controls.Contains($lbl_Progress))
			{
				$groupBox_Details.Controls.Remove($lbl_Progress)
			}
			if ($groupBox_Details.Controls.Contains($dataGrid_IndividualInfo))
			{
				$groupBox_Details.Controls.Remove($dataGrid_IndividualInfo)
			}
		
			[System.Windows.Forms.MessageBox]::Show($_)
		
		}
	}
	
	function GetObjectLevelQueryResults ()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Data.DataTable])]
		param
		(
			[parameter(Mandatory = $true, Position = 0)]
			[string]$ServerName,
			
			[parameter(Mandatory = $true, Position = 1)]
			[string]$DBName,
			
			[parameter(Mandatory = $true, Position = 2)]
			[string]$Query
		)
		try
		{
			$ErrorActionPreference = 'Stop'	
				
			$Sqlconn = New-Object System.Data.SqlClient.SqlConnection("Server=$ServerName;Database=$DBName;Trusted_Connection=true;")
			$Sqlconn.Open()
			$sqlcommand = $Sqlconn.CreateCommand()
			$sqlcommand.CommandText = $Query
			$sqlcommand.CommandTimeout = 20
			$adapter = New-Object System.Data.SqlClient.SqlDataAdapter($sqlcommand)
			$tblQueryResult = New-Object System.Data.DataTable
			$adapter.Fill($tblQueryResult) | Out-Null
	
			return, $tblQueryResult
		}
		catch [Exception]
		{
		  [System.Windows.Forms.MessageBox]::Show($_)
			
		}
	}
	
	
	function GetInstanceLevelQueryReport_Results ()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Data.DataTable])]
		param
		(
			[parameter(Mandatory = $true, Position = 0)]
			[string]$ServerName,
			[parameter(Mandatory = $true, Position = 1)]
			[string]$Query
		)
		try
		{
			$ErrorActionPreference = 'Stop'
			$lbl_Progress.Visible = $true
			
			if (!$groupBox_Report.Controls.Contains($lbl_Progress))
			{
				$groupBox_Report.Controls.Add($lbl_Progress)
				$groupBox_Report.Refresh()
			}
					
			$Sqlconn = New-Object System.Data.SqlClient.SqlConnection("Server=$ServerName;Trusted_Connection=true;")
			$Sqlconn.Open()
			$sqlcommand = $Sqlconn.CreateCommand()
			$sqlcommand.CommandText = $Query
			$sqlcommand.CommandTimeout = 20
			$adapter = New-Object System.Data.SqlClient.SqlDataAdapter($sqlcommand)
			$tblQueryResult = New-Object System.Data.DataTable
			$adapter.Fill($tblQueryResult) | Out-Null		
			
			return, $tblQueryResult
		}
		catch [Exception]
		{
			$tabName = "tblinstanceLevelInfo"
			$table = New-Object System.Data.DataTable "$tabName"
			$SQL_Instance = New-Object System.Data.DataColumn "SQL_Instance", ([string])
			$ErrorMsg = New-Object System.Data.DataColumn "ErrorMsg", ([string])
			
			$table.Columns.Add($SQL_Instance)
			$table.Columns.Add($ErrorMsg)
			$row = $table.NewRow()
			$row."SQL_Instance" = $ServerName
			$row."ErrorMsg" = $_
			$table.Rows.Add($row)
			return ,$table
		}
	}
	
	function EnableNoteContent()
	{
		try
		{
			if (!$groupBox_Note.Controls.Contains($label_Note1))
			{
				$groupBox_Note.Controls.Add($label_Note1)
			}
			if (!$groupBox_Note.Controls.Contains($label_Note2))
			{
				$groupBox_Note.Controls.Add($label_Note2)
			}
			
			if ($label_Note1.Text -eq '')
			{ $label_Note1.Visible = $false }
			else
			{ $label_Note1.Visible = $true }
			
			if ($label_Note2.Text -eq '')
			{ $label_Note2.Visible = $false }
			else
			{ $label_Note2.Visible = $true }
					
			$groupBox_Note.Refresh()
		}
		catch [exception]
		{
			$label_Note1.Test = ""
			$label_Note2.Text = "" 
		}
	}
	
	function DiableNoteContent()
	{
		try
		{
			$label_Note1.Visible = $false
			$label_Note2.Visible = $false
			$groupBox_Note.Refresh()
		}
		catch [exception]
		{
			$label_Note1.Test = ""
			$label_Note2.Text = ""
		}	
	}
	
	function GridSize()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Drawing.Size])]
		param
		(
			[parameter(Mandatory = $true, Position = 0)]
			[int]$rowCount		
		)	
		try
		{
			$grid_size = New-Object System.Drawing.Size
			$grid_size.Width = $global:gridReportwidth				
				
			if ($rowCount -eq 0)
			{
				$grid_size.Height = 40
			}
			if  ($rowCount -eq 1)
			{
				$grid_size.Height = 48
			}
			if ($rowCount -eq 2)
			{
				$grid_size.Height = 70
			}
			if ($rowCount -eq 3)
			{
				$grid_size.Height = 92
			}
			if ($rowCount -eq 4)
			{
				$grid_size.Height = 115
			}
			if ($rowCount -eq 5)
			{
				$grid_size.Height = 138
			}
			if ($rowCount -eq 6)
			{
				$grid_size.Height = 160
			}
			if ($rowCount -eq 7)
			{
				$grid_size.Height = 181
			}
			if ($rowCount -eq 8)
			{
				$grid_size.Height = 203
			}
			if ($rowCount -eq 9)
			{
				$grid_size.Height = 226
			}
			if ($rowCount -eq 10)
			{
				$grid_size.Height = 249
			}
			if ($rowCount -eq 10)
			{
				$grid_size.Height = 272
			}
			if ($rowCount -ge 10)
			{
				$grid_size.Height = 295
			}
			return, $grid_size
		}
		catch
		{	  
		}
	}
	
	
	function TraverseTree([System.Windows.Forms.TreeNodeCollection] $nodes)
	{
		foreach ($child in $nodes)
		{
			  $allnodes.Add($child.Text)		
			  TraverseTree($child.Nodes);			
		}
	}
	
	function AvailabilityCheck ()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Int32])]
		param
		(
			[parameter(Mandatory = $true, Position = 0)]
			[string]$ServerName,
			[parameter(Mandatory = $true, Position = 1)]
			[string]$AvailablityType
		)
		try
			{
				if ($AvailablityType -eq 'AG')
				{
					$Query = 'select  from sys.dm_hadr_availability_replica_states'
				}
				elseif ($AvailablityType -eq 'Mirroring')
				{
					$Query = 'select  from sys.database_mirroring where mirroring_guid IS NOT NULL'
				}
				else
				{
					$Query = 'sp_help_log_shipping_monitor'
				}
				$Sqlconn = New-Object System.Data.SqlClient.SqlConnection("Server=$ServerName;Trusted_Connection=true;")
				$Sqlconn.Open()
				$sqlcommand = $Sqlconn.CreateCommand()
				$sqlcommand.CommandText = $Query
				$sqlcommand.CommandTimeout = 20
				$adapter = New-Object System.Data.SqlClient.SqlDataAdapter($sqlcommand)
				$tblQueryResult = New-Object System.Data.DataTable
				$adapter.Fill($tblQueryResult) | Out-Null
				
				if ($tblQueryResult.Rows.Count -gt 0)
				{
					return 1
				}
				else
				{
					return 0
				}
				
			}
			catch
			{
				
			}
		
	}
	
	function ValidateSQLConnectivity()
	{
		[CmdletBinding(DefaultParameterSetName = "None")]
		[OutputType([System.Int32])]
		param
		(
			[parameter(Mandatory = $true, Position = 0)]
			[string]$ServerName
		)
		try
		{
			$lbl_Progress.Visible = $true
			
			if (!$groupBox_Report.Controls.Contains($lbl_Progress))
			{
				$groupBox_Report.Controls.Add($lbl_Progress)
				$groupBox_Report.Refresh()
			}		
			
			$Sqlconn = New-Object System.Data.SqlClient.SqlConnection("Server=$ServerName;Trusted_Connection=true;")
			$Sqlconn.Open()
			return 1
		}
		catch [System.Exception]
		{
			[System.Windows.Forms.MessageBox]::Show($_)		
		}
	}
	
	$exitToolStripMenuItem_Click={
		#TODO: Place custom script here
		$formSQLDBAToolWF.Close()
	}
	
	$aboutToolStripMenuItem_Click={
		#TODO: Place custom script here
		[System.Windows.Forms.MessageBox]::Show("Menu Application v1.0","Menu Application");
	}
	
	
	#region Control Helper Functions
	function Update-DataGridView
	{
		<#
		.SYNOPSIS
			This functions helps you load items into a DataGridView.
	
		.DESCRIPTION
			Use this function to dynamically load items into the DataGridView control.
	
		.PARAMETER  DataGridView
			The DataGridView control you want to add items to.
	
		.PARAMETER  Item
			The object or objects you wish to load into the DataGridView's items collection.
		
		.PARAMETER  DataMember
			Sets the name of the list or table in the data source for which the DataGridView is displaying data.
	
		.PARAMETER AutoSizeColumns
		    Resizes DataGridView control's columns after loading the items.
		#>
		Param (
			[ValidateNotNull()]
			[Parameter(Mandatory=$true)]
			[System.Windows.Forms.DataGridView]$DataGridView,
			[ValidateNotNull()]
			[Parameter(Mandatory=$true)]
			$Item,
		    [Parameter(Mandatory=$false)]
			[string]$DataMember,
			[System.Windows.Forms.DataGridViewAutoSizeColumnsMode]$AutoSizeColumns = 'None'
		)
		$DataGridView.SuspendLayout()
		$DataGridView.DataMember = $DataMember
		
		if ($null -eq $Item)
		{
			$DataGridView.DataSource = $null
		}
		elseif ($Item -is [System.Data.DataSet] -and $Item.Tables.Count -gt 0)
		{
			$DataGridView.DataSource = $Item.Tables[0]
		}
		elseif ($Item -is [System.ComponentModel.IListSource]`
		-or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView] )
		{
			$DataGridView.DataSource = $Item
		}
		else
		{
			$array = New-Object System.Collections.ArrayList
			
			if ($Item -is [System.Collections.IList])
			{
				$array.AddRange($Item)
			}
			else
			{
				$array.Add($Item)
			}
			$DataGridView.DataSource = $array
		}
		
		if ($AutoSizeColumns -ne 'None')
		{
			$DataGridView.AutoResizeColumns($AutoSizeColumns)
		}
		
		$DataGridView.ResumeLayout()
	}
	
	function ConvertTo-DataTable
	{
		<#
			.SYNOPSIS
				Converts objects into a DataTable.
		
			.DESCRIPTION
				Converts objects into a DataTable, which are used for DataBinding.
		
			.PARAMETER  InputObject
				The input to convert into a DataTable.
		
			.PARAMETER  Table
				The DataTable you wish to load the input into.
		
			.PARAMETER RetainColumns
				This switch tells the function to keep the DataTable's existing columns.
			
			.PARAMETER FilterWMIProperties
				This switch removes WMI properties that start with an underline.
		
			.EXAMPLE
				$DataTable = ConvertTo-DataTable -InputObject (Get-Process)
		#>
		[OutputType([System.Data.DataTable])]
		param(
		$InputObject, 
		[ValidateNotNull()]
		[System.Data.DataTable]$Table,
		[switch]$RetainColumns,
		[switch]$FilterWMIProperties)
		
		if($null -eq $Table)
		{
			$Table = New-Object System.Data.DataTable
		}
		
		if ($null -eq $InputObject)
		{
			$Table.Clear()
			return @( ,$Table)
		}
		
		if ($InputObject -is [System.Data.DataTable])
		{
			$Table = $InputObject
		}
		elseif ($InputObject -is [System.Data.DataSet] -and $InputObject.Tables.Count -gt 0)
		{
			$Table = $InputObject.Tables[0]
		}
		else
		{
			if (-not $RetainColumns -or $Table.Columns.Count -eq 0)
			{
				#Clear out the Table Contents
				$Table.Clear()
				
				if ($null -eq $InputObject) { return } #Empty Data
				
				$object = $null
				#find the first non null value
				foreach ($item in $InputObject)
				{
					if ($null -ne $item)
					{
						$object = $item
						break
					}
				}
				
				if ($null -eq $object) { return } #All null then empty
				
				#Get all the properties in order to create the columns
				foreach ($prop in $object.PSObject.Get_Properties())
				{
					if (-not $FilterWMIProperties -or -not $prop.Name.StartsWith('__')) #filter out WMI properties
					{
						#Get the type from the Definition string
						$type = $null
						
						if ($null -ne $prop.Value)
						{
							try { $type = $prop.Value.GetType() }
							catch { Out-Null }
						}
						
						if ($null -ne $type) # -and [System.Type]::GetTypeCode($type) -ne 'Object')
						{
							[void]$table.Columns.Add($prop.Name, $type)
						}
						else #Type info not found
						{
							[void]$table.Columns.Add($prop.Name)
						}
					}
				}
				
				if ($object -is [System.Data.DataRow])
				{
					foreach ($item in $InputObject)
					{
						$Table.Rows.Add($item)
					}
					return @( ,$Table)
				}
			}
			else
			{
				$Table.Rows.Clear()
			}
			
			foreach ($item in $InputObject)
			{
				$row = $table.NewRow()
				
				if ($item)
				{
					foreach ($prop in $item.PSObject.Get_Properties())
					{
						if ($table.Columns.Contains($prop.Name))
						{
							$row.Item($prop.Name) = $prop.Value
						}
					}
				}
				[void]$table.Rows.Add($row)
			}
		}
		
		return @(,$Table)
	}
	
	function Get-CheckedNode
	{
	<#
		.SYNOPSIS
			This function collects a list of checked nodes in a TreeView
	
		.DESCRIPTION
			This function collects a list of checked nodes in a TreeView
	
		.PARAMETER  $NodeCollection
			The collection of nodes to search
	
		.PARAMETER  $CheckedNodes
			The ArrayList that will contain the all the checked items
		
		.EXAMPLE
			$CheckedNodes = New-Object System.Collections.ArrayList
			Get-CheckedNode $treeview1.Nodes $CheckedNodes
			foreach($node in $CheckedNodes)
			{	
				Write-Host $node.Text
			}
	#>
		param (
				[ValidateNotNull()]
				[System.Windows.Forms.TreeNodeCollection]$NodeCollection,
				[ValidateNotNull()]
				[System.Collections.ArrayList]$CheckedNodes
		)
		
		foreach ($Node in $NodeCollection)
		{
			if ($Node.Checked)
			{
				[void]$CheckedNodes.Add($Node)
			}
			Get-CheckedNode $Node.Nodes $CheckedNodes
		}
	}
	
	
	function Update-Chart
	{
	<#
	    .SYNOPSIS
	        This functions helps you plot points on a chart
	    
	    .DESCRIPTION
	        Use the function to plot points on a chart or add more charts to a chart control
	    
	    .PARAMETER ChartControl
	        The Chart Control you when to add points to
	    
	    .PARAMETER XPoints
	        Set the X Axis Points. These can be strings or numerical values.
	    
	    .PARAMETER YPoints
	        Set the Y Axis Points. These can be strings or numerical values.
	    
	    .PARAMETER XTitle
	        Set the Title for the X Axis.
	    
	    .PARAMETER YTitle
	        Set the Title for the Y Axis.
	    
	    .PARAMETER Title
	        Set the Title for the chart.
	    
	    .PARAMETER ChartType
	        Set the Style of the chart. See System.Windows.Forms.DataVisualization.Charting.SeriesChartType Enum
	    
	    .PARAMETER SeriesIndex
	        Set the settings of a particular Series and corresponding ChartArea
	    
	    .PARAMETER TitleIndex
	        Set the settings of a particular Title
	    
	    .PARAMETER SeriesName
	        Set the settings of a particular Series using its name and corresponding ChartArea.
	        The Series will be created if not found.
	        If SeriesIndex is set, it will replace the Series' name if the Series does not exist
	    
	    .PARAMETER Enable3D
	        The chart will be rendered in 3D.
	    
	    .PARAMETER Disable3D
	        The chart will be rendered in 2D.
	    
	    .PARAMETER AppendNew
	        When this switch is used, a new ChartArea is added to Chart Control.
	    
	    .NOTES
	        Additional information about the function.
	    
	    .LINK
	        http://www.sapien.com/blog/2011/05/05/primalforms-2011-designing-charts-for-powershell/
	#>
		
		param
		(
			[Parameter(Mandatory = $true, Position = 1)]
			[ValidateNotNull()]
			[System.Windows.Forms.DataVisualization.Charting.Chart]$ChartControl,
			[Parameter(Mandatory = $true, Position = 2)]
			[ValidateNotNull()]
			$XPoints,
			[Parameter(Mandatory = $true, Position = 3)]
			$YPoints,
			[Parameter(Mandatory = $false, Position = 4)]
			[string]$XTitle,
			[Parameter(Mandatory = $false, Position = 5)]
			[string]$YTitle,
			[Parameter(Mandatory = $false, Position = 6)]
			[string]$Title,
			[Parameter(Mandatory = $false, Position = 7)]
			[System.Windows.Forms.DataVisualization.Charting.SeriesChartType]$ChartType,
			[Parameter(Mandatory = $false, Position = 8)]
			[int]$SeriesIndex = -1,
			[Parameter(Mandatory = $false, Position = 9)]
			[int]$TitleIndex = 0,
			[Parameter(Mandatory = $false)]
			[string]$SeriesName = $null,
			[switch]$Enable3D,
			[switch]$Disable3D,
			[switch]$AppendNew
		)
		
		$ChartAreaIndex = 0
		if ($AppendNew)
		{
			$name = "ChartArea " + ($ChartControl.ChartAreas.Count + 1).ToString();
			$ChartArea = $ChartControl.ChartAreas.Add($name)
			$ChartAreaIndex = $ChartControl.ChartAreas.Count - 1
			
			$name = "Series " + ($ChartControl.Series.Count + 1).ToString();
			$Series = $ChartControl.Series.Add($name)
			$SeriesIndex = $ChartControl.Series.Count - 1
			
			$Series.ChartArea = $ChartArea.Name
			
			if ($Title)
			{
				$name = "Title " + ($ChartControl.Titles.Count + 1).ToString();
				$TitleObj = $ChartControl.Titles.Add($Title)
				$TitleIndex = $ChartControl.Titles.Count - 1
				$TitleObj.DockedToChartArea = $ChartArea.Name
				$TitleObj.IsDockedInsideChartArea = $false
			}
		}
		else
		{
			if ($ChartControl.ChartAreas.Count -eq 0)
			{
				$name = "ChartArea " + ($ChartControl.ChartAreas.Count + 1).ToString();
				[void]$ChartControl.ChartAreas.Add($name)
				$ChartAreaIndex = $ChartControl.ChartAreas.Count - 1
			}
			
			if ($ChartControl.Series.Count -eq 0)
			{
				if (-not $SeriesName)
				{
					$SeriesName = "Series " + ($ChartControl.Series.Count + 1).ToString();
				}
				
				$Series = $ChartControl.Series.Add($SeriesName)
				$SeriesIndex = $ChartControl.Series.Count - 1
				$Series.ChartArea = $ChartControl.ChartAreas[$ChartAreaIndex].Name
			}
			elseif ($SeriesName)
			{
				$Series = $ChartControl.Series.FindByName($SeriesName)
				
				if ($null -eq $Series)
				{
					if (($SeriesIndex -gt -1) -and ($SeriesIndex -lt $ChartControl.Series.Count))
					{
						$Series = $ChartControl.Series[$SeriesIndex]
						$Series.Name = $SeriesName
					}
					else
					{
						$Series = $ChartControl.Series.Add($SeriesName)
						$SeriesIndex = $ChartControl.Series.Count - 1
					}
					
					$Series.ChartArea = $ChartControl.ChartAreas[$ChartAreaIndex].Name
				}
				else
				{
					$SeriesIndex = $ChartControl.Series.IndexOf($Series)
					$ChartAreaIndex = $ChartControl.ChartAreas.IndexOf($Series.ChartArea)
				}
			}
		}
		
		if (($SeriesIndex -lt 0) -or ($SeriesIndex -ge $ChartControl.Series.Count))
		{
			$SeriesIndex = 0
		}
		
		$Series = $ChartControl.Series[$SeriesIndex]
		$Series.Points.Clear()
		$ChartArea = $ChartControl.ChartAreas[$Series.ChartArea]
		
		if ($Enable3D)
		{
			$ChartArea.Area3DStyle.Enable3D = $true
		}
		elseif ($Disable3D)
		{
			$ChartArea.Area3DStyle.Enable3D = $false
		}
		
		if ($Title)
		{
			if ($ChartControl.Titles.Count -eq 0)
			{
				#$name = "Title " + ($ChartControl.Titles.Count + 1).ToString();
				$TitleObj = $ChartControl.Titles.Add($Title)
				$TitleIndex = $ChartControl.Titles.Count - 1
				$TitleObj.DockedToChartArea = $ChartArea.Name
				$TitleObj.IsDockedInsideChartArea = $false
			}
			
			$ChartControl.Titles[$TitleIndex].Text = $Title
		}
		
		if ($ChartType)
		{
			$Series.ChartType = $ChartType
		}
		
		if ($XTitle)
		{
			$ChartArea.AxisX.Title = $XTitle
		}
		
		if ($YTitle)
		{
			$ChartArea.AxisY.Title = $YTitle
		}
		
		if ($XPoints -isnot [Array] -or $XPoints -isnot [System.Collections.IEnumerable])
		{
			$array = New-Object System.Collections.ArrayList
			$array.Add($XPoints)
			$XPoints = $array
		}
		
		if ($YPoints -isnot [Array] -or $YPoints -isnot [System.Collections.IEnumerable])
		{
			$array = New-Object System.Collections.ArrayList
			$array.Add($YPoints)
			$YPoints = $array
		}
		
		$Series.Points.DataBindXY($XPoints, $YPoints)
	}
	
	
	function Clear-Chart
	{
	<#
		.SYNOPSIS
			This function clears the contents of the chart
	
		.DESCRIPTION
			Use the function to remove contents from the chart control
	
		.PARAMETER  ChartControl
			The Chart Control to clear
	
		.PARAMETER  LeaveSingleChart
			Leaves the first chart and removes all others from the control
		
		.LINK
			http://www.sapien.com/blog/2011/05/05/primalforms-2011-designing-charts-for-powershell/
	#>
		Param (	
		[ValidateNotNull()]
		[Parameter(Position=1,Mandatory=$true)]
	  	[System.Windows.Forms.DataVisualization.Charting.Chart]$ChartControl
		,
		[Parameter(Position=2, Mandatory=$false)]
		[Switch]$LeaveSingleChart
		)
		
		$count = 0	
		if($LeaveSingleChart)
		{
			$count = 1
		}
		
		while($ChartControl.Series.Count -gt $count)
		{
			$ChartControl.Series.RemoveAt($ChartControl.Series.Count - 1)
		}
		
		while($ChartControl.ChartAreas.Count -gt $count)
		{
			$ChartControl.ChartAreas.RemoveAt($ChartControl.ChartAreas.Count - 1)
		}
		
		while($ChartControl.Titles.Count -gt $count)
		{
			$ChartControl.Titles.RemoveAt($ChartControl.Titles.Count - 1)
		}
		
		if($ChartControl.Series.Count -gt 0)
		{
			$ChartControl.Series[0].Points.Clear()
		}
	}
	
	function Update-ListBox
	{
	<#
		.SYNOPSIS
			This functions helps you load items into a ListBox or CheckedListBox.
		
		.DESCRIPTION
			Use this function to dynamically load items into the ListBox control.
		
		.PARAMETER ListBox
			The ListBox control you want to add items to.
		
		.PARAMETER Items
			The object or objects you wish to load into the ListBox's Items collection.
		
		.PARAMETER DisplayMember
			Indicates the property to display for the items in this control.
		
		.PARAMETER Append
			Adds the item(s) to the ListBox without clearing the Items collection.
		
		.EXAMPLE
			Update-ListBox $ListBox1 "Red", "White", "Blue"
		
		.EXAMPLE
			Update-ListBox $listBox1 "Red" -Append
			Update-ListBox $listBox1 "White" -Append
			Update-ListBox $listBox1 "Blue" -Append
		
		.EXAMPLE
			Update-ListBox $listBox1 (Get-Process) "ProcessName"
		
		.NOTES
			Additional information about the function.
	#>
		
		param
		(
			[Parameter(Mandatory = $true)]
			[ValidateNotNull()]
			[System.Windows.Forms.ListBox]
			$ListBox,
			[Parameter(Mandatory = $true)]
			[ValidateNotNull()]
			$Items,
			[Parameter(Mandatory = $false)]
			[string]
			$DisplayMember,
			[switch]
			$Append
		)
		
		if (-not $Append)
		{
			$listBox.Items.Clear()
		}
		
		if ($Items -is [System.Windows.Forms.ListBox+ObjectCollection])
		{
			$listBox.Items.AddRange($Items)
		}
		elseif ($Items -is [Array])
		{
			$listBox.BeginUpdate()
			foreach ($obj in $Items)
			{
				$listBox.Items.Add($obj)
			}
			$listBox.EndUpdate()
		}
		else
		{
			$listBox.Items.Add($Items)
		}
		
		$listBox.DisplayMember = $DisplayMember
	}
	
	function Update-ComboBox
	{
	<#
		.SYNOPSIS
			This functions helps you load items into a ComboBox.
		
		.DESCRIPTION
			Use this function to dynamically load items into the ComboBox control.
		
		.PARAMETER ComboBox
			The ComboBox control you want to add items to.
		
		.PARAMETER Items
			The object or objects you wish to load into the ComboBox's Items collection.
		
		.PARAMETER DisplayMember
			Indicates the property to display for the items in this control.
			
		.PARAMETER ValueMember
			Indicates the property to use for the value of the control.
		
		.PARAMETER Append
			Adds the item(s) to the ComboBox without clearing the Items collection.
		
		.EXAMPLE
			Update-ComboBox $combobox1 "Red", "White", "Blue"
		
		.EXAMPLE
			Update-ComboBox $combobox1 "Red" -Append
			Update-ComboBox $combobox1 "White" -Append
			Update-ComboBox $combobox1 "Blue" -Append
		
		.EXAMPLE
			Update-ComboBox $combobox1 (Get-Process) "ProcessName"
		
		.NOTES
			Additional information about the function.
	#>
		
		param
		(
			[Parameter(Mandatory = $true)]
			[ValidateNotNull()]
			[System.Windows.Forms.ComboBox]
			$ComboBox,
			[Parameter(Mandatory = $true)]
			[ValidateNotNull()]
			$Items,
			[Parameter(Mandatory = $false)]
			[string]$DisplayMember,
			[Parameter(Mandatory = $false)]
			[string]$ValueMember,
			[switch]
			$Append
		)
		
		if (-not $Append)
		{
			$ComboBox.Items.Clear()
		}
		
		if ($Items -is [Object[]])
		{
			$ComboBox.Items.AddRange($Items)
		}
		elseif ($Items -is [System.Collections.IEnumerable])
		{
			$ComboBox.BeginUpdate()
			foreach ($obj in $Items)
			{
				$ComboBox.Items.Add($obj)
			}
			$ComboBox.EndUpdate()
		}
		else
		{
			$ComboBox.Items.Add($Items)
		}
		
		$ComboBox.DisplayMember = $DisplayMember
		$ComboBox.ValueMember = $ValueMember
	}
	#endregion
	

	
	$cbx_SQLDBSelection_SelectedIndexChanged={
		if ($cbx_SQLDBSelection.SelectedItem.ToString() -eq "Instance-Level")
		{
			$lbl_SQLInstance.Visible = $true
			$textbox_SQLInstance.Visible = $true
			
			$lbl_DBName.Visible = $false
			$combo_DBSelection.Visible = $false
			
			$treeview_DBLevel.Visible = $false
			$treeViewObject.Visible = $false
			$treeview_Feature.Visible = $true
			
			
			#$lblObject.Visible = $false
			$cmbBoxObjectsDisplay.Visible = $false
			
			$lblType.Visible = $false
			$cmbBoxObjectType.Visible = $false
			
			
			$dataGrid_IndividualInfo.DataSource = $null
			$dataGrid_IndividualInfo.Refresh()
			$groupBox_Details.Refresh()
			
		}
		
		
		if ($cbx_SQLDBSelection.SelectedItem.ToString() -eq "Database-Level")
		{
			$lbl_SQLInstance.Visible = $true
			$textbox_SQLInstance.Visible = $true
			
			$lbl_DBName.Visible = $true
			$combo_DBSelection.Visible = $true
			
			$treeview_Feature.Visible = $false
			$treeViewObject.Visible = $false
			$treeview_DBLevel.Visible = $true
			
			#$lblObject.Visible = $false
			$cmbBoxObjectsDisplay.Visible = $false
			
			$lblType.Visible = $false
			$cmbBoxObjectType.Visible = $false
			
			$treeview_DBLevel.Refresh()
			
			$dataGrid_IndividualInfo.DataSource = $null
			$dataGrid_IndividualInfo.Refresh()
			$groupBox_Details.Refresh()
			
			if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
			{
				$Query_DBName = "select name from sys.databases order by name asc"
				$combo_DBSelection.DataSource = GetInstanceLevelQueryResults -ServerName $textbox_SQLInstance.Text -Query $Query_DBName
				$combo_DBSelection.DisplayMember = 'name'
			}
			
		}
		
		if ($cbx_SQLDBSelection.SelectedItem.ToString() -eq "Object-Level")
		{
			$lbl_SQLInstance.Visible = $true
			$textbox_SQLInstance.Visible = $true
			
			$lbl_DBName.Visible = $true
			$combo_DBSelection.Visible = $true
			
			$treeview_Feature.Visible = $false
			$treeview_DBLevel.Visible = $false
			$treeViewObject.Visible = $true
			
			#$lblObject.Visible = $true
			$cmbBoxObjectsDisplay.Visible = $true
			
			$lblType.Visible = $true
			$cmbBoxObjectType.Visible=$true
			
			$dataGrid_IndividualInfo.DataSource = $null
			$dataGrid_IndividualInfo.Refresh()
			$groupBox_Details.Refresh()
			
			$treeview_DBLevel.Refresh()	
			
			
			if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
			{
				$Query_DBName = "select name from sys.databases order by name asc"
				$combo_DBSelection.DataSource = GetInstanceLevelQueryResults -ServerName $textbox_SQLInstance.Text -Query $Query_DBName
				$combo_DBSelection.DisplayMember = 'name'
			}
			
		}
		
	}
	
	$treeview_Feature_NodeMouseClick=[System.Windows.Forms.TreeNodeMouseClickEventHandler]{
		#Event Argument: $_ = [System.Windows.Forms.TreeNodeMouseClickEventArgs]
		
		if ($_.Node.Text -eq 'Overall report')
		{
			
			$groupBox_Details.Visible = $false
			$groupBox_Note.Visible = $false
			$groupBox_Report.Visible = $true
			
			$groupBox_Report.Controls.Clear()
			$groupBox_Report.Refresh()
			
			if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
			{
				
				<#$returnValue = ValidateSQLConnectivity -ServerName $textbox_SQLInstance.Text
				if ($returnValue -eq "OK")
				{
					return 0
				}#>
				
				$userconfirmation = [System.Windows.Forms.MessageBox]::Show("Overall report takes few minutes to generate, do you want to proceed ?", "Confirmation", [System.Windows.Forms.MessageBoxButtons]::OKCancel)
				switch ($userconfirmation)
				{
					"OK" {			
											
						
						
						$labelLocX = 10
						$labelLocY = 20
						
						$gridLocX = 10
						$gridLocY = 40
						
						
						$panel_Report = New-Object 'System.Windows.Forms.Panel'
						$panel_Report.Location = '10, 17'
						$panel_Report.Name = 'panelReport'
						
						$PanelSize = New-Object System.Drawing.Size
						$PanelSize.Width = $groupBox_Report.Size.Width - 20
						$PanelSize.Height = $groupBox_Report.Size.Height - 25
						
						$panel_Report.Size = $PanelSize
						$panel_Report.BorderStyle = 'FixedSingle'
						$panel_Report.AutoScroll = $true
						
						
						$gridviewReport_ActualSize = New-Object System.Drawing.Size
						$gridviewReport_ActualSize.Width = $panel_Report.Size.Width - 35
						$gridviewReport_ActualSize.Height = 100
						
						$global:gridReportwidth = $gridviewReport_ActualSize.Width
						
						$allnodes.Clear()
						TraverseTree($treeview_Feature.Nodes);
						
												
						foreach ($item in $allnodes)
						{
							#skip paraent nodes
							if ($item -in ('SQL health & Availability', 'SQL service status', 'SQL Connections'))
							{
								continue
							}
							#skip AG if Instance is not confugured with AG
							if ($item -in ('testing'))
							{
								[int32] $result=AvailabilityCheck -ServerName $textbox_SQLInstance.Text -AvailablityType 'AG'
								if ($result -eq 0)
								{
									continue
								}
								
							}
							#skip Mirroring if Instance is not confugured with Mirroring
							if ($item -in ('xyz'))
							{
								[int32]$result = AvailabilityCheck -ServerName $textbox_SQLInstance.Text -AvailablityType 'Mirroring'
								if ($result -eq 0)
								{
									continue
								}
								
							}
							#skip Logshipping if Instance is not confugured with Logshipping
							if ($item -in ('SQL connection Info'))
							{
								[int32]$result = AvailabilityCheck -ServerName $textbox_SQLInstance.Text -AvailablityType 'LS'
								if ($result -eq 0)
								{
									continue
								}
								
							}
							$labelReport = New-Object System.Windows.Forms.Label
							$labelReport.Text = $item.ToString()
							$labelReport.AutoSize = $true
							$labelReport.Name = "LabelReport_" + $item.ToString()
							$labelReport.Font = [System.Drawing.Font]::new("Microsoft Sans Serif", 9, [System.Drawing.FontStyle]::Bold)
							$labelReport.Location = New-Object System.Drawing.Size($labelLocX, $labelLocY)
							$panel_Report.Controls.Add($labelReport)
							
							
							$gridviewReport = New-Object System.Windows.Forms.DataGridView
							$gridviewReport.Name = "gridViewReport_" + $item.ToString()
							$gridviewReport.DataMember = ""
							$gridviewReport.ReadOnly = $true
							$gridviewReport.BackgroundColor = "White"						
							$gridviewReport.AllowUserToAddRows = $false
							$gridviewReport.AutoSizeColumnsMode = "AllCells"
							$gridloc = New-Object System.Drawing.Point
							$gridloc.X = $gridLocX
							$gridloc.Y = $gridLocY
							$gridviewReport.Location = $gridloc
							$gridviewReport.Size = $gridviewReport_ActualSize
							$datatable = New-Object System.Data.DataTable
							if ($item -eq 'Running status')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus1
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Sp_who2')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus2
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'SQL connection Info')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus3
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Sp_whoIsActive')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus4
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Connection count by login')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text-Query $query_SQLRunningStatus5
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Connection count by login')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus6
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Connection count by login')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus8
								$gridviewReport.DataSource = $datatable
							}
							if ($item -eq 'Sp_who2')
							{
								$datatable = GetInstanceLevelQueryReport_Results -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus10
								$gridviewReport.DataSource = $datatable
							}
							$gridviewReport.Size = GridSize -rowCount $datatable.Rows.Count						
												
							$panel_Report.Controls.Add($gridviewReport)
							
							$labelLocY = $labelLocY + $gridviewReport.Size.Height + ($gridLocY - $labelLocY) + 10
							$gridLocY = $labelLocY + 20
							
						}
						$groupBox_Report.Controls.Add($panel_Report)
						
						foreach ($control  in $panel_Report.Controls)
						{
							if ($control.GetType().ToString() -eq 'System.Windows.Forms.DataGridView')
							{
								if ($control.Name -eq 'gridViewReport_Running status')
								{
									foreach ($row in $control.Rows)
									{
										if ($row.Cells[0].value -eq 'master')
										{
											# CHange color of the current row modify
											$row.DefaultCellStyle.BackColor = 'cyan'
										}
										
									}
								}
								
								if ($control.Name -eq 'gridViewReport_Sp_who2')
								{
									foreach ($row in $control.Rows)
									{
										if ($row.Cells[0].value -eq 'master')
										{
											# CHange color of the current row modify
											$row.DefaultCellStyle.BackColor = 'cyan'
										}
										
									}
								}
								
								
							}
							
						}
						if ($groupBox_Report.Controls.Contains($lbl_Progress))
						{
							$lbl_Progress.Visible = $false
							#$groupBox_Report.Control.Remove($lbl_Progress)			
						}
						$groupBox_Report.refresh()
					}
					"Cancel"{
						
					}
				}
			}
			else
			{
				[System.Windows.Forms.MessageBox]::Show('Enter server name')
			}
		}
		
		if ($_.Node.Text -ne 'Overall report')
			{
				$groupBox_Details.Visible = $true
				$groupBox_Note.Visible = $true
				$groupBox_Report.Visible = $false
					
			
			if ($_.Node.Text -eq 'Running status')
			{			
				if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
				{
					DiableNoteContent
					$dataGrid_IndividualInfo.DataSource = GetInstanceLevelQueryResults -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus
					
					foreach ($row in $dataGrid_IndividualInfo.Rows)
					{
						if ($row.Cells['name'].Value -eq 'master')
						{
							$row.DefaultCellStyle.BackColor = 'cyan'
						}
					}
					$dataGrid_IndividualInfo.refresh()
					$groupBox_Details.Refresh()
					
					$label_Note1.Text = '1. Note1'
					$label_Note2.Text = '2. Note2'
					
					EnableNoteContent
				}
				else
				{
					[System.Windows.Forms.MessageBox]::Show('Enter server name')
				}	
				
			}	
			
		
			
		}
		
	}
	
	$treeview_DBLevel_NodeMouseClick=[System.Windows.Forms.TreeNodeMouseClickEventHandler]{
	#Event Argument: $_ = [System.Windows.Forms.TreeNodeMouseClickEventArgs]
		if ($_.Node.Text -eq 'Overall report')
		{		
			if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
			{
			$userconfirmation = [System.Windows.Forms.MessageBox]::Show("Overall report takes few minutes to generate, do you want to proceed ?", "Confirmation", [System.Windows.Forms.MessageBoxButtons]::OKCancel)
			switch ($userconfirmation)
			{
				"OK" {
					$groupBox_Details.Visible = $false
					$groupBox_Note.Visible = $false
					$groupBox_Report.Visible = $true
					
					$groupBox_Report.Controls.Clear()
					$groupBox_Report.Refresh()
					
					$labelLocX = 10
					$labelLocY = 20
					
					$gridLocX = 10
					$gridLocY = 40
					
					
					$panel_Report = New-Object 'System.Windows.Forms.Panel'
					$panel_Report.Location = '10, 17'
					$panel_Report.Name = 'panelReport'
					
					$PanelSize = New-Object System.Drawing.Size
					$PanelSize.Width = $groupBox_Report.Size.Width - 20
					$PanelSize.Height = $groupBox_Report.Size.Height - 25
					
					$panel_Report.Size = $PanelSize
					$panel_Report.BorderStyle = 'FixedSingle'
					$panel_Report.AutoScroll = $true
					
					
					$gridviewReport_ActualSize = New-Object System.Drawing.Size
					$gridviewReport_ActualSize.Width = $panel_Report.Size.Width - 35
					$gridviewReport_ActualSize.Height = 100
					
					$global:gridReportwidth = $gridviewReport_ActualSize.Width
					
					$allnodes.Clear()
					TraverseTree($treeview_Feature.Nodes);
					
					foreach ($item in $allnodes)
					{
						if ($item -in ('SQL health & Availability'))
						{
							continue
						}
						$labelReport = New-Object System.Windows.Forms.Label
						$labelReport.Text = $item.ToString()
						$labelReport.AutoSize = $true
						$labelReport.Name = "LabelReport_" + $item.ToString()
						$labelReport.Font = [System.Drawing.Font]::new("Microsoft Sans Serif", 9, [System.Drawing.FontStyle]::Bold)
						$labelReport.Location = New-Object System.Drawing.Size($labelLocX, $labelLocY)
						$panel_Report.Controls.Add($labelReport)
						
						
						$gridviewReport = New-Object System.Windows.Forms.DataGridView
						$gridviewReport.Name = "gridViewReport_" + $item.ToString()
						$gridviewReport.DataMember = ""
						$gridviewReport.ReadOnly = $true
						$gridviewReport.BackgroundColor = "White"
						#$gridviewReport.BorderStyle = "None"
						$gridviewReport.AllowUserToAddRows = $false
						$gridviewReport.AutoSizeColumnsMode = "AllCells"
						$gridloc = New-Object System.Drawing.Point
						$gridloc.X = $gridLocX
						$gridloc.Y = $gridLocY
						$gridviewReport.Location = $gridloc
						$gridviewReport.Size = $gridviewReport_ActualSize
						$datatable = New-Object System.Data.DataTable
						$datatable = GetInstanceLevelQueryReport_Results -ServerName 'DESKTOP-UBHDU56\NODE1' -Query $tb_DBNameQuery
						$gridviewReport.DataSource = $datatable
						$gridviewReport.Size = GridSize -rowCount $datatable.Rows.Count
						
						$panel_Report.Controls.Add($gridviewReport)
						
						$labelLocY = $labelLocY + $gridviewReport.Size.Height + ($gridLocY - $labelLocY) + 10
						$gridLocY = $labelLocY + 20
						
					}
					$groupBox_Report.Controls.Add($panel_Report)
					
					foreach ($control  in $panel_Report.Controls)
					{
						if ($control.GetType().ToString() -eq 'System.Windows.Forms.DataGridView')
						{
							if ($control.Name -eq 'gridViewReport_Running status')
							{
								foreach ($row in $control.Rows)
								{
									if ($row.Cells[0].value -eq 'master')
									{
										# CHange color of the current row modify
										$row.DefaultCellStyle.BackColor = 'cyan'
									}
									
								}
							}
							
							if ($control.Name -eq 'gridViewReport_Sp_who2')
							{
								foreach ($row in $control.Rows)
								{
									if ($row.Cells[0].value -eq 'master')
									{
										# CHange color of the current row modify
										$row.DefaultCellStyle.BackColor = 'cyan'
									}
									
								}
							}
							
							
						}
						
					}
					if ($groupBox_Report.Controls.Contains($lbl_Progress))
					{
						$lbl_Progress.Visible = $false
						#$groupBox_Report.Control.Remove($lbl_Progress)			
					}
					$groupBox_Report.refresh()
				}
				"Cancel"{				
				}
				}			
			}
			else
			{
				[System.Windows.Forms.MessageBox]::Show('Enter server name')
			}		
		}
		
		if ($_.Node.Text -ne 'Overall report')
		{
			$groupBox_Details.Visible = $true
			$groupBox_Note.Visible = $true
			$groupBox_Report.Visible = $false
			
			if ($_.Node.Text -eq 'Running status')
			{
				<#$dataGrid_IndividualInfo.DataSource = GetInstanceLevelQueryResults -ServerName 'DESKTOP-UBHDU56\NODE1' -Query $query_SQLRunningStatus
				
				foreach ($row in $dataGrid_IndividualInfo.Rows)
				{
					if ($row.Cells['name'].Value -eq 'master')
					{
						$row.DefaultCellStyle.BackColor = 'cyan'
					}
				}
				$dataGrid_IndividualInfo.refresh()
				$groupBox_Details.Refresh()#>
				
				if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
				{
					DiableNoteContent
					$dataGrid_IndividualInfo.DataSource = GetInstanceLevelQueryResults -ServerName $textbox_SQLInstance.Text -Query $query_SQLRunningStatus
					
					foreach ($row in $dataGrid_IndividualInfo.Rows)
					{
						if ($row.Cells['name'].Value -eq 'master')
						{
							$row.DefaultCellStyle.BackColor = 'cyan'
						}
					}
					$dataGrid_IndividualInfo.refresh()
					$groupBox_Details.Refresh()
					
					$label_Note1.Text = '1. Note1'
					$label_Note2.Text = '2. Note2'
					
					EnableNoteContent
				}			
				else
				{
					[System.Windows.Forms.MessageBox]::Show('Enter server name')
				}
			}
			
	
	}
	
	
	}
	
	$textbox_SQLInstance_Leave={
		
		if ($cbx_SQLDBSelection.SelectedItem.ToString() -eq "Database-Level")
		{
			try
			{
				$ErrorActionPreference = 'Stop'
				if ([string]::IsNullOrEmpty($textbox_SQLInstance.Text))
				{
					[System.Windows.Forms.MessageBox]::Show('Enter server name')
				}
				if (![string]::IsNullOrEmpty($textbox_SQLInstance.Text))
				{
					$Query_DBName = "select name from sys.databases order by name asc"					
					$combo_DBSelection.DataSource = GetInstanceLevelQueryResults -ServerName $textbox_SQLInstance.Text -Query $Query_DBName
					$combo_DBSelection.DisplayMember ='name'
				}
			}
			catch [Exception]
			{
				$combo_DBSelection.DataSource = $null			
			}
		}
		
	}
	
	
	$cmbBoxObjectType_SelectedIndexChanged={	
	
		$DBSelectedName = $combo_DBSelection.SelectedItem[0];
		if ($cmbBoxObjectType.SelectedItem.ToString() -eq "Tables")
		{
			
			$Query_Tables = "select table_name FROM information_schema.tables ORDER BY table_name ASC"
			$cmbBoxObjectsDisplay.DataSource = GetObjectLevelQueryResults -ServerName $textbox_SQLInstance.Text -DBName $DBSelectedName -Query $Query_Tables
			$cmbBoxObjectsDisplay.DisplayMember = 'table_name'
			
		}
		
		if ($cmbBoxObjectType.SelectedItem.ToString() -eq "Storedprocedures")
		{
			$Query = "SELECT name  FROM dbo.sysobjects  WHERE (type = 'P')"
			$cmbBoxObjectsDisplay.DataSource = GetObjectLevelQueryResults -ServerName $textbox_SQLInstance.Text -DBName $DBSelectedName -Query $Query
			$cmbBoxObjectsDisplay.DisplayMember = 'name'
			
			
		}
		if ($cmbBoxObjectType.SelectedItem.ToString() -eq "Views")
		{
			$Query = "select  name from sys.views order by name"
			$cmbBoxObjectsDisplay.DataSource = GetObjectLevelQueryResults -ServerName $textbox_SQLInstance.Text -DBName $DBSelectedName -Query $Query
			$cmbBoxObjectsDisplay.DisplayMember = 'name'
		}
	}
	
	$combo_DBSelection_SelectedIndexChanged = {
		$global:comboDBSelectedItem=''
		$global:comboDBSelectedItem=$combo_DBSelection.SelectedItem.ToString()
		
	}
	
	# --End User Generated Script--
	#----------------------------------------------
	#region Generated Events
	#----------------------------------------------
	
	$Form_StateCorrection_Load=
	{
		#Correct the initial state of the form to prevent the .Net maximized form issue
		$formSQLDBAToolWF.WindowState = $InitialFormWindowState
	}
	
	$Form_Cleanup_FormClosed=
	{
		#Remove all event handlers from the controls
		try
		{
			$treeview_Feature.remove_NodeMouseClick($treeview_Feature_NodeMouseClick)
			$treeview_DBLevel.remove_NodeMouseClick($treeview_DBLevel_NodeMouseClick)
			$cmbBoxObjectType.remove_SelectedIndexChanged($cmbBoxObjectType_SelectedIndexChanged)
			$textbox_SQLInstance.remove_Leave($textbox_SQLInstance_Leave)
			$combo_DBSelection.remove_SelectedIndexChanged($combo_DBSelection_SelectedIndexChanged)
			$cbx_SQLDBSelection.remove_SelectedIndexChanged($cbx_SQLDBSelection_SelectedIndexChanged)
			$formSQLDBAToolWF.remove_Load($formSQLDBAToolWF_Load)
			$exitToolStripMenuItem.remove_Click($exitToolStripMenuItem_Click)
			$aboutToolStripMenuItem.remove_Click($aboutToolStripMenuItem_Click)
			$formSQLDBAToolWF.remove_Load($Form_StateCorrection_Load)
			$formSQLDBAToolWF.remove_FormClosed($Form_Cleanup_FormClosed)
		}
		catch { Out-Null <# Prevent PSScriptAnalyzer warning #> }
	}
	#endregion Generated Events

	#----------------------------------------------
	#region Generated Form Code
	#----------------------------------------------
	$formSQLDBAToolWF.SuspendLayout()
	$tbCntrlEacoChecklist.SuspendLayout()
	$tabpage1.SuspendLayout()
	$groupBox_Details.SuspendLayout()
	$groupbox1.SuspendLayout()
	$grpbox_ServerDetails.SuspendLayout()
	$menustrip1.SuspendLayout()
	#
	# formSQLDBAToolWF
	#
	$formSQLDBAToolWF.Controls.Add($tbCntrlEacoChecklist)
	$formSQLDBAToolWF.Controls.Add($menustrip1)
	$formSQLDBAToolWF.AutoScaleDimensions = '6, 13'
	$formSQLDBAToolWF.AutoScaleMode = 'Font'
	$formSQLDBAToolWF.ClientSize = '1121, 606'
	$formSQLDBAToolWF.FormBorderStyle = 'FixedToolWindow'
	$formSQLDBAToolWF.MainMenuStrip = $menustrip1
	$formSQLDBAToolWF.MaximizeBox = $False
	$formSQLDBAToolWF.Name = 'formSQLDBAToolWF'
	$formSQLDBAToolWF.StartPosition = 'CenterScreen'
	$formSQLDBAToolWF.Text = 'SQL DBA- Tool (WF)'
	$formSQLDBAToolWF.add_Load($formSQLDBAToolWF_Load)
	#
	# tbCntrlEacoChecklist
	#
	$tbCntrlEacoChecklist.Controls.Add($tabpage1)
	$tbCntrlEacoChecklist.Location = '0, 27'
	$tbCntrlEacoChecklist.Name = 'tbCntrlEacoChecklist'
	$tbCntrlEacoChecklist.SelectedIndex = 0
	$tbCntrlEacoChecklist.Size = '1121, 577'
	$tbCntrlEacoChecklist.TabIndex = 1
	#
	# tabpage1
	#
	$tabpage1.Controls.Add($groupBox_Details)
	$tabpage1.Controls.Add($groupBox_Report)
	$tabpage1.Controls.Add($groupBox_Note)
	$tabpage1.Controls.Add($groupbox1)
	$tabpage1.Controls.Add($grpbox_ServerDetails)
	$tabpage1.Location = '4, 22'
	$tabpage1.Name = 'tabpage1'
	$tabpage1.Padding = '3, 3, 3, 3'
	$tabpage1.Size = '1113, 551'
	$tabpage1.TabIndex = 0
	$tabpage1.Text = 'EACO-CHECKLIST'
	$tabpage1.UseVisualStyleBackColor = $True
	#
	# groupBox_Details
	#
	$groupBox_Details.Controls.Add($lbl_Progress)
	$groupBox_Details.Controls.Add($dataGrid_IndividualInfo)
	$groupBox_Details.Location = '267, 87'
	$groupBox_Details.Name = 'groupBox_Details'
	$groupBox_Details.Size = '838, 403'
	$groupBox_Details.TabIndex = 4
	$groupBox_Details.TabStop = $False
	$groupBox_Details.Text = 'Details'
	$groupBox_Details.UseCompatibleTextRendering = $True
	#
	# lbl_Progress
	#
	$lbl_Progress.AutoSize = $True
	$lbl_Progress.Font = 'Microsoft Sans Serif, 9.75pt'
	$lbl_Progress.Location = '332, 177'
	$lbl_Progress.Name = 'lbl_Progress'
	$lbl_Progress.Size = '134, 20'
	$lbl_Progress.TabIndex = 1
	$lbl_Progress.Text = 'Loading.. please wait.'
	$lbl_Progress.UseCompatibleTextRendering = $True
	$lbl_Progress.Visible = $False
	#
	# dataGrid_IndividualInfo
	#
	$dataGrid_IndividualInfo.AllowUserToAddRows = $False
	$dataGrid_IndividualInfo.AutoSizeColumnsMode = 'AllCells'
	$dataGrid_IndividualInfo.BackgroundColor = 'White'
	$dataGrid_IndividualInfo.ColumnHeadersHeightSizeMode = 'AutoSize'
	$dataGrid_IndividualInfo.Location = '6, 16'
	$dataGrid_IndividualInfo.Name = 'dataGrid_IndividualInfo'
	$dataGrid_IndividualInfo.ReadOnly = $True
	$dataGrid_IndividualInfo.Size = '826, 379'
	$dataGrid_IndividualInfo.TabIndex = 0
	#
	# groupBox_Report
	#
	$groupBox_Report.AccessibleRole = 'ScrollBar'
	$groupBox_Report.Location = '263, 89'
	$groupBox_Report.Name = 'groupBox_Report'
	$groupBox_Report.Size = '842, 459'
	$groupBox_Report.TabIndex = 5
	$groupBox_Report.TabStop = $False
	$groupBox_Report.Text = 'Overall Report'
	$groupBox_Report.UseCompatibleTextRendering = $True
	$groupBox_Report.Visible = $False
	#
	# groupBox_Note
	#
	$groupBox_Note.Location = '266, 488'
	$groupBox_Note.Name = 'groupBox_Note'
	$groupBox_Note.Size = '839, 60'
	$groupBox_Note.TabIndex = 3
	$groupBox_Note.TabStop = $False
	$groupBox_Note.Text = 'Note:'
	$groupBox_Note.UseCompatibleTextRendering = $True
	#
	# groupbox1
	#
	$groupbox1.Controls.Add($treeViewObject)
	$groupbox1.Controls.Add($treeview_Feature)
	$groupbox1.Controls.Add($treeview_DBLevel)
	$groupbox1.Location = '8, 87'
	$groupbox1.Name = 'groupbox1'
	$groupbox1.Size = '252, 461'
	$groupbox1.TabIndex = 1
	$groupbox1.TabStop = $False
	$groupbox1.Text = 'Select'
	$groupbox1.UseCompatibleTextRendering = $True
	#
	# treeViewObject
	#
	$treeViewObject.BorderStyle = 'None'
	$treeViewObject.Location = '9, 16'
	$treeViewObject.Name = 'treeViewObject'
	$System_Windows_Forms_TreeNode_1 = New-Object 'System.Windows.Forms.TreeNode' ('Tables')
	$System_Windows_Forms_TreeNode_1.Name = 'Tables'
	$System_Windows_Forms_TreeNode_1.Text = 'Tables'
	[void]$treeViewObject.Nodes.Add($System_Windows_Forms_TreeNode_1)
	$System_Windows_Forms_TreeNode_2 = New-Object 'System.Windows.Forms.TreeNode' ('Stored Procedures')
	$System_Windows_Forms_TreeNode_2.Name = 'Stored Procedures'
	$System_Windows_Forms_TreeNode_2.Text = 'Stored Procedures'
	[void]$treeViewObject.Nodes.Add($System_Windows_Forms_TreeNode_2)
	$System_Windows_Forms_TreeNode_3 = New-Object 'System.Windows.Forms.TreeNode' ('Views')
	$System_Windows_Forms_TreeNode_3.Name = 'Views'
	$System_Windows_Forms_TreeNode_3.Text = 'Views'
	[void]$treeViewObject.Nodes.Add($System_Windows_Forms_TreeNode_3)
	$treeViewObject.Size = '240, 436'
	$treeViewObject.TabIndex = 2
	$treeViewObject.Visible = $False
	#
	# treeview_Feature
	#
	$treeview_Feature.BorderStyle = 'None'
	$treeview_Feature.Location = '9, 16'
	$treeview_Feature.Name = 'treeview_Feature'
	$System_Windows_Forms_TreeNode_6 = New-Object 'System.Windows.Forms.TreeNode' ('Running status')
	$System_Windows_Forms_TreeNode_6.Name = 'Running status'
	$System_Windows_Forms_TreeNode_6.Text = 'Running status'
	$System_Windows_Forms_TreeNode_5 = New-Object 'System.Windows.Forms.TreeNode' ('SQL service status', [System.Windows.Forms.TreeNode[]] ($System_Windows_Forms_TreeNode_6))
	$System_Windows_Forms_TreeNode_5.Name = 'SQL service status'
	$System_Windows_Forms_TreeNode_5.Text = 'SQL service status'
	$System_Windows_Forms_TreeNode_4 = New-Object 'System.Windows.Forms.TreeNode' ('SQL health & Availability', [System.Windows.Forms.TreeNode[]] ($System_Windows_Forms_TreeNode_5))
	$System_Windows_Forms_TreeNode_4.Name = 'SQL health & Availability'
	$System_Windows_Forms_TreeNode_4.Text = 'SQL health & Availability'
	[void]$treeview_Feature.Nodes.Add($System_Windows_Forms_TreeNode_4)
	$System_Windows_Forms_TreeNode_7 = New-Object 'System.Windows.Forms.TreeNode' ('Error Logs')
	$System_Windows_Forms_TreeNode_7.Name = 'Error Logs'
	$System_Windows_Forms_TreeNode_7.Text = 'Error Logs'
	[void]$treeview_Feature.Nodes.Add($System_Windows_Forms_TreeNode_7)
	$System_Windows_Forms_TreeNode_8 = New-Object 'System.Windows.Forms.TreeNode' ('SQL Performance')
	$System_Windows_Forms_TreeNode_8.Name = 'SQL Performance'
	$System_Windows_Forms_TreeNode_8.Text = 'SQL Performance'
	[void]$treeview_Feature.Nodes.Add($System_Windows_Forms_TreeNode_8)
	$System_Windows_Forms_TreeNode_9 = New-Object 'System.Windows.Forms.TreeNode' ('High Availability')
	$System_Windows_Forms_TreeNode_9.Name = 'High Availability'
	$System_Windows_Forms_TreeNode_9.Text = 'High Availability'
	[void]$treeview_Feature.Nodes.Add($System_Windows_Forms_TreeNode_9)
	$System_Windows_Forms_TreeNode_11 = New-Object 'System.Windows.Forms.TreeNode' ('Overall report')
	$System_Windows_Forms_TreeNode_11.Name = 'Overall report'
	$System_Windows_Forms_TreeNode_11.Text = 'Overall report'
	$System_Windows_Forms_TreeNode_12 = New-Object 'System.Windows.Forms.TreeNode' ('Overall report(HTML)')
	$System_Windows_Forms_TreeNode_12.Name = 'Overall report(HTML)'
	$System_Windows_Forms_TreeNode_12.Text = 'Overall report(HTML)'
	$System_Windows_Forms_TreeNode_10 = New-Object 'System.Windows.Forms.TreeNode' ('Reports', [System.Windows.Forms.TreeNode[]] ($System_Windows_Forms_TreeNode_11, $System_Windows_Forms_TreeNode_12))
	$System_Windows_Forms_TreeNode_10.Name = 'Reports'
	$System_Windows_Forms_TreeNode_10.Text = 'Reports'
	[void]$treeview_Feature.Nodes.Add($System_Windows_Forms_TreeNode_10)
	$treeview_Feature.Size = '240, 436'
	$treeview_Feature.TabIndex = 0
	$treeview_Feature.add_NodeMouseClick($treeview_Feature_NodeMouseClick)
	#
	# treeview_DBLevel
	#
	$treeview_DBLevel.BorderStyle = 'None'
	$treeview_DBLevel.Location = '9, 16'
	$treeview_DBLevel.Name = 'treeview_DBLevel'
	$System_Windows_Forms_TreeNode_14 = New-Object 'System.Windows.Forms.TreeNode' ('Database state')
	$System_Windows_Forms_TreeNode_14.Name = 'Database state'
	$System_Windows_Forms_TreeNode_14.Text = 'Database state'
	$System_Windows_Forms_TreeNode_15 = New-Object 'System.Windows.Forms.TreeNode' ('No.of sessons on database')
	$System_Windows_Forms_TreeNode_15.Name = 'No.of sessons on database'
	$System_Windows_Forms_TreeNode_15.Text = 'No.of sessons on database'
	$System_Windows_Forms_TreeNode_16 = New-Object 'System.Windows.Forms.TreeNode' ('Database file size/space')
	$System_Windows_Forms_TreeNode_16.Name = 'Database file size/space'
	$System_Windows_Forms_TreeNode_16.Text = 'Database file size/space'
	$System_Windows_Forms_TreeNode_17 = New-Object 'System.Windows.Forms.TreeNode' ('VLF count')
	$System_Windows_Forms_TreeNode_17.Name = 'VLF count'
	$System_Windows_Forms_TreeNode_17.Text = 'VLF count'
	$System_Windows_Forms_TreeNode_18 = New-Object 'System.Windows.Forms.TreeNode' ('Lock waits for database')
	$System_Windows_Forms_TreeNode_18.Name = 'Lock waits for database'
	$System_Windows_Forms_TreeNode_18.Text = 'Lock waits for database'
	$System_Windows_Forms_TreeNode_19 = New-Object 'System.Windows.Forms.TreeNode' ('Buffer used by database')
	$System_Windows_Forms_TreeNode_19.Name = 'Buffer used by database'
	$System_Windows_Forms_TreeNode_19.Text = 'Buffer used by database'
	$System_Windows_Forms_TreeNode_20 = New-Object 'System.Windows.Forms.TreeNode' ('Database stats')
	$System_Windows_Forms_TreeNode_20.Name = 'Database stats'
	$System_Windows_Forms_TreeNode_20.Text = 'Database stats'
	$System_Windows_Forms_TreeNode_21 = New-Object 'System.Windows.Forms.TreeNode' ('Lock waits for database')
	$System_Windows_Forms_TreeNode_21.Name = 'Lock waits for database'
	$System_Windows_Forms_TreeNode_21.Text = 'Lock waits for database'
	$System_Windows_Forms_TreeNode_22 = New-Object 'System.Windows.Forms.TreeNode' ('Indexes used by table')
	$System_Windows_Forms_TreeNode_22.Name = 'Indexes used by table'
	$System_Windows_Forms_TreeNode_22.Text = 'Indexes used by table'
	$System_Windows_Forms_TreeNode_23 = New-Object 'System.Windows.Forms.TreeNode' ('Possible bad Non-clustered Indexes')
	$System_Windows_Forms_TreeNode_23.Name = 'Possible bad Non-clustered Indexes'
	$System_Windows_Forms_TreeNode_23.Text = 'Possible bad Non-clustered Indexes'
	$System_Windows_Forms_TreeNode_24 = New-Object 'System.Windows.Forms.TreeNode' ('Memory used db objects')
	$System_Windows_Forms_TreeNode_24.Name = 'Memory used db objects'
	$System_Windows_Forms_TreeNode_24.Text = 'Memory used db objects'
	$System_Windows_Forms_TreeNode_25 = New-Object 'System.Windows.Forms.TreeNode' ('Database fill factor')
	$System_Windows_Forms_TreeNode_25.Name = 'Database fill factor'
	$System_Windows_Forms_TreeNode_25.Text = 'Database fill factor'
	$System_Windows_Forms_TreeNode_26 = New-Object 'System.Windows.Forms.TreeNode' ('Missing Index warnings for cached plans')
	$System_Windows_Forms_TreeNode_26.Name = 'Missing Index warnings for cached plans'
	$System_Windows_Forms_TreeNode_26.Text = 'Missing Index warnings for cached plans'
	$System_Windows_Forms_TreeNode_27 = New-Object 'System.Windows.Forms.TreeNode' ('Index statistics')
	$System_Windows_Forms_TreeNode_27.Name = 'Index statistics'
	$System_Windows_Forms_TreeNode_27.Text = 'Index statistics'
	$System_Windows_Forms_TreeNode_28 = New-Object 'System.Windows.Forms.TreeNode' ('Top cached SPs by avg time')
	$System_Windows_Forms_TreeNode_28.Name = 'Top cached SPs by avg time'
	$System_Windows_Forms_TreeNode_28.Text = 'Top cached SPs by avg time'
	$System_Windows_Forms_TreeNode_29 = New-Object 'System.Windows.Forms.TreeNode' ('Most expensive SPs(I/O)')
	$System_Windows_Forms_TreeNode_29.Name = 'Most expensive SPs(I/O)'
	$System_Windows_Forms_TreeNode_29.Text = 'Most expensive SPs(I/O)'
	$System_Windows_Forms_TreeNode_30 = New-Object 'System.Windows.Forms.TreeNode' ('Expensive SPs(cpu)')
	$System_Windows_Forms_TreeNode_30.Name = 'Expensive SPs(cpu)'
	$System_Windows_Forms_TreeNode_30.Text = 'Expensive SPs(cpu)'
	$System_Windows_Forms_TreeNode_31 = New-Object 'System.Windows.Forms.TreeNode' ('Most I/O latch Indexes')
	$System_Windows_Forms_TreeNode_31.Name = 'Most I/O latch Indexes'
	$System_Windows_Forms_TreeNode_31.Text = 'Most I/O latch Indexes'
	$System_Windows_Forms_TreeNode_32 = New-Object 'System.Windows.Forms.TreeNode' ('Missing Indexes by advantage')
	$System_Windows_Forms_TreeNode_32.Name = 'Missing Indexes by advantage'
	$System_Windows_Forms_TreeNode_32.Text = 'Missing Indexes by advantage'
	$System_Windows_Forms_TreeNode_33 = New-Object 'System.Windows.Forms.TreeNode' ('Missing Indexes')
	$System_Windows_Forms_TreeNode_33.Name = 'Missing Indexes'
	$System_Windows_Forms_TreeNode_33.Text = 'Missing Indexes'
	$System_Windows_Forms_TreeNode_34 = New-Object 'System.Windows.Forms.TreeNode' ('Unused Indexes')
	$System_Windows_Forms_TreeNode_34.Name = 'Unused Indexes'
	$System_Windows_Forms_TreeNode_34.Text = 'Unused Indexes'
	$System_Windows_Forms_TreeNode_13 = New-Object 'System.Windows.Forms.TreeNode' ('DB Level', [System.Windows.Forms.TreeNode[]] ($System_Windows_Forms_TreeNode_14, $System_Windows_Forms_TreeNode_15, $System_Windows_Forms_TreeNode_16, $System_Windows_Forms_TreeNode_17, $System_Windows_Forms_TreeNode_18, $System_Windows_Forms_TreeNode_19, $System_Windows_Forms_TreeNode_20, $System_Windows_Forms_TreeNode_21, $System_Windows_Forms_TreeNode_22, $System_Windows_Forms_TreeNode_23, $System_Windows_Forms_TreeNode_24, $System_Windows_Forms_TreeNode_25, $System_Windows_Forms_TreeNode_26, $System_Windows_Forms_TreeNode_27, $System_Windows_Forms_TreeNode_28, $System_Windows_Forms_TreeNode_29, $System_Windows_Forms_TreeNode_30, $System_Windows_Forms_TreeNode_31, $System_Windows_Forms_TreeNode_32, $System_Windows_Forms_TreeNode_33, $System_Windows_Forms_TreeNode_34))
	$System_Windows_Forms_TreeNode_13.Name = 'DB Level'
	$System_Windows_Forms_TreeNode_13.Text = 'DB Level'
	[void]$treeview_DBLevel.Nodes.Add($System_Windows_Forms_TreeNode_13)
	$System_Windows_Forms_TreeNode_36 = New-Object 'System.Windows.Forms.TreeNode' ('Overall report')
	$System_Windows_Forms_TreeNode_36.Name = 'Overall report'
	$System_Windows_Forms_TreeNode_36.Text = 'Overall report'
	$System_Windows_Forms_TreeNode_37 = New-Object 'System.Windows.Forms.TreeNode' ('Overall report(HTML)')
	$System_Windows_Forms_TreeNode_37.Name = 'Overall report(HTML)'
	$System_Windows_Forms_TreeNode_37.Text = 'Overall report(HTML)'
	$System_Windows_Forms_TreeNode_35 = New-Object 'System.Windows.Forms.TreeNode' ('Reports', [System.Windows.Forms.TreeNode[]] ($System_Windows_Forms_TreeNode_36, $System_Windows_Forms_TreeNode_37))
	$System_Windows_Forms_TreeNode_35.Name = 'Reports'
	$System_Windows_Forms_TreeNode_35.Text = 'Reports'
	[void]$treeview_DBLevel.Nodes.Add($System_Windows_Forms_TreeNode_35)
	$treeview_DBLevel.Size = '240, 436'
	$treeview_DBLevel.TabIndex = 1
	$treeview_DBLevel.Visible = $False
	$treeview_DBLevel.add_NodeMouseClick($treeview_DBLevel_NodeMouseClick)
	#
	# grpbox_ServerDetails
	#
	$grpbox_ServerDetails.Controls.Add($cmbBoxObjectType)
	$grpbox_ServerDetails.Controls.Add($lblType)
	$grpbox_ServerDetails.Controls.Add($cmbBoxObjectsDisplay)
	$grpbox_ServerDetails.Controls.Add($textbox_SQLInstance)
	$grpbox_ServerDetails.Controls.Add($picBox)
	$grpbox_ServerDetails.Controls.Add($combo_DBSelection)
	$grpbox_ServerDetails.Controls.Add($lbl_DBName)
	$grpbox_ServerDetails.Controls.Add($lbl_SQLInstance)
	$grpbox_ServerDetails.Controls.Add($cbx_SQLDBSelection)
	$grpbox_ServerDetails.Controls.Add($lbl_Instance_DB)
	$grpbox_ServerDetails.Location = '8, 15'
	$grpbox_ServerDetails.Name = 'grpbox_ServerDetails'
	$grpbox_ServerDetails.Size = '1097, 72'
	$grpbox_ServerDetails.TabIndex = 0
	$grpbox_ServerDetails.TabStop = $False
	$grpbox_ServerDetails.Text = 'Server details'
	$grpbox_ServerDetails.UseCompatibleTextRendering = $True
	#
	# cmbBoxObjectType
	#
	$cmbBoxObjectType.FormattingEnabled = $True
	[void]$cmbBoxObjectType.Items.Add('Tables')
	[void]$cmbBoxObjectType.Items.Add('StoredProcedures')
	[void]$cmbBoxObjectType.Items.Add('Views')
	$cmbBoxObjectType.Location = '753, 27'
	$cmbBoxObjectType.Name = 'cmbBoxObjectType'
	$cmbBoxObjectType.Size = '125, 21'
	$cmbBoxObjectType.TabIndex = 10
	$cmbBoxObjectType.Text = '--Select--'
	$cmbBoxObjectType.Visible = $False
	$cmbBoxObjectType.add_SelectedIndexChanged($cmbBoxObjectType_SelectedIndexChanged)
	#
	# lblType
	#
	$lblType.AutoSize = $True
	$lblType.Location = '718, 30'
	$lblType.Name = 'lblType'
	$lblType.Size = '29, 17'
	$lblType.TabIndex = 9
	$lblType.Text = 'Type'
	$lblType.UseCompatibleTextRendering = $True
	$lblType.Visible = $False
	#
	# cmbBoxObjectsDisplay
	#
	$cmbBoxObjectsDisplay.FormattingEnabled = $True
	$cmbBoxObjectsDisplay.Location = '897, 27'
	$cmbBoxObjectsDisplay.Name = 'cmbBoxObjectsDisplay'
	$cmbBoxObjectsDisplay.Size = '121, 21'
	$cmbBoxObjectsDisplay.TabIndex = 8
	$cmbBoxObjectsDisplay.Text = '-- Select --'
	$cmbBoxObjectsDisplay.Visible = $False
	#
	# textbox_SQLInstance
	#
	$textbox_SQLInstance.Location = '358, 25'
	$textbox_SQLInstance.Name = 'textbox_SQLInstance'
	$textbox_SQLInstance.Size = '134, 20'
	$textbox_SQLInstance.TabIndex = 6
	$textbox_SQLInstance.add_Leave($textbox_SQLInstance_Leave)
	#
	# picBox
	#
	$picBox.ImageLocation = 'c:\temp\text.png'
	$picBox.Location = '1024, 11'
	$picBox.Name = 'picBox'
	$picBox.Size = '67, 55'
	$picBox.SizeMode = 'StretchImage'
	$picBox.TabIndex = 5
	$picBox.TabStop = $False
	#
	# combo_DBSelection
	#
	$combo_DBSelection.FormattingEnabled = $True
	$combo_DBSelection.Location = '578, 28'
	$combo_DBSelection.Name = 'combo_DBSelection'
	$combo_DBSelection.Size = '121, 21'
	$combo_DBSelection.TabIndex = 4
	$combo_DBSelection.Text = '--Select--'
	$combo_DBSelection.add_SelectedIndexChanged($combo_DBSelection_SelectedIndexChanged)
	#
	# lbl_DBName
	#
	$lbl_DBName.AutoSize = $True
	$lbl_DBName.Location = '519, 30'
	$lbl_DBName.Name = 'lbl_DBName'
	$lbl_DBName.Size = '53, 17'
	$lbl_DBName.TabIndex = 3
	$lbl_DBName.Text = 'DB Name'
	$lbl_DBName.UseCompatibleTextRendering = $True
	#
	# lbl_SQLInstance
	#
	$lbl_SQLInstance.AutoSize = $True
	$lbl_SQLInstance.Location = '279, 28'
	$lbl_SQLInstance.Name = 'lbl_SQLInstance'
	$lbl_SQLInstance.Size = '73, 17'
	$lbl_SQLInstance.TabIndex = 2
	$lbl_SQLInstance.Text = 'SQL-Instance'
	$lbl_SQLInstance.UseCompatibleTextRendering = $True
	#
	# cbx_SQLDBSelection
	#
	$cbx_SQLDBSelection.FormattingEnabled = $True
	[void]$cbx_SQLDBSelection.Items.Add('Instance-Level')
	[void]$cbx_SQLDBSelection.Items.Add('Database-Level')
	[void]$cbx_SQLDBSelection.Items.Add('Object-Level')
	$cbx_SQLDBSelection.Location = '138, 27'
	$cbx_SQLDBSelection.Name = 'cbx_SQLDBSelection'
	$cbx_SQLDBSelection.Size = '135, 21'
	$cbx_SQLDBSelection.TabIndex = 1
	$cbx_SQLDBSelection.Text = '--Select--'
	$cbx_SQLDBSelection.add_SelectedIndexChanged($cbx_SQLDBSelection_SelectedIndexChanged)
	#
	# lbl_Instance_DB
	#
	$lbl_Instance_DB.AutoSize = $True
	$lbl_Instance_DB.Location = '34, 31'
	$lbl_Instance_DB.Name = 'lbl_Instance_DB'
	$lbl_Instance_DB.Size = '98, 17'
	$lbl_Instance_DB.TabIndex = 0
	$lbl_Instance_DB.Text = 'Instance / DB level'
	$lbl_Instance_DB.UseCompatibleTextRendering = $True
	#
	# menustrip1
	#
	[void]$menustrip1.Items.Add($fileToolStripMenuItem)
	[void]$menustrip1.Items.Add($helpToolStripMenuItem)
	$menustrip1.Location = '0, 0'
	$menustrip1.Name = 'menustrip1'
	$menustrip1.Size = '1121, 24'
	$menustrip1.TabIndex = 0
	$menustrip1.Text = 'menustrip1'
	#
	# fileToolStripMenuItem
	#
	[void]$fileToolStripMenuItem.DropDownItems.Add($exitToolStripMenuItem)
	$fileToolStripMenuItem.Name = 'fileToolStripMenuItem'
	$fileToolStripMenuItem.Size = '37, 20'
	$fileToolStripMenuItem.Text = 'File'
	#
	# exitToolStripMenuItem
	#
	$exitToolStripMenuItem.Name = 'exitToolStripMenuItem'
	$exitToolStripMenuItem.Size = '93, 22'
	$exitToolStripMenuItem.Text = 'Exit'
	$exitToolStripMenuItem.add_Click($exitToolStripMenuItem_Click)
	#
	# helpToolStripMenuItem
	#
	[void]$helpToolStripMenuItem.DropDownItems.Add($aboutToolStripMenuItem)
	$helpToolStripMenuItem.Name = 'helpToolStripMenuItem'
	$helpToolStripMenuItem.Size = '44, 20'
	$helpToolStripMenuItem.Text = 'Help'
	#
	# aboutToolStripMenuItem
	#
	$aboutToolStripMenuItem.Name = 'aboutToolStripMenuItem'
	$aboutToolStripMenuItem.Size = '107, 22'
	$aboutToolStripMenuItem.Text = 'About'
	$aboutToolStripMenuItem.add_Click($aboutToolStripMenuItem_Click)
	#
	# labelLabel2
	#
	$labelLabel2.AutoSize = $True
	$labelLabel2.Location = '781, 436'
	$labelLabel2.Name = 'labelLabel2'
	$labelLabel2.Size = '35, 17'
	$labelLabel2.TabIndex = 1
	$labelLabel2.Text = 'label2'
	$labelLabel2.UseCompatibleTextRendering = $True
	#
	# button1
	#
	$button1.Location = '0, 0'
	$button1.Name = 'button1'
	$button1.Size = '75, 23'
	$button1.TabIndex = 0
	$button1.Text = 'button1'
	$button1.UseCompatibleTextRendering = $True
	$button1.UseVisualStyleBackColor = $True
	$menustrip1.ResumeLayout()
	$grpbox_ServerDetails.ResumeLayout()
	$groupbox1.ResumeLayout()
	$groupBox_Details.ResumeLayout()
	$tabpage1.ResumeLayout()
	$tbCntrlEacoChecklist.ResumeLayout()
	$formSQLDBAToolWF.ResumeLayout()
	#endregion Generated Form Code

	#----------------------------------------------

	#Save the initial state of the form
	$InitialFormWindowState = $formSQLDBAToolWF.WindowState
	#Init the OnLoad event to correct the initial state of the form
	$formSQLDBAToolWF.add_Load($Form_StateCorrection_Load)
	#Clean up the control events
	$formSQLDBAToolWF.add_FormClosed($Form_Cleanup_FormClosed)
	#Show the Form
	return $formSQLDBAToolWF.ShowDialog()

} #End Function

#Call the form
Show-MIM_Checklist_psf | Out-Null
